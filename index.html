<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Solicitud de Viaje</title>
</head>
<body>
  <h1>Solicitud de Viaje de Negocios</h1>
  
  <form id="formSolicitud">
    <label>Título:
      <input type="text" id="titulo" required>
    </label><br><br>
    
    <label>Fecha de inicio:
      <input type="date" id="fechaInicio" required>
    </label><br><br>
    
    <label>Fecha de fin:
      <input type="date" id="fechaFin" required>
    </label><br><br>
    
    <label>Destino:
      <input type="text" id="destino" required>
    </label><br><br>
    
    <label>
      <input type="checkbox" id="equipoEmpresa">
      Necesito usar equipo de la empresa
    </label><br>
    
    <label>
      <input type="checkbox" id="vpn">
      Necesito conectarme a la VPN
    </label><br>
    
    <label>
      <input type="checkbox" id="dispositivoMovil">
      Necesito utilizar un dispositivo móvil
    </label><br><br>
    
    <label>Comentarios:
      <textarea id="comentarios"></textarea>
    </label><br><br>
    
    <button type="submit">Enviar solicitud</button>
  </form>

  <script>
    const flujoUrl = "https://default19685a3e7dde400fbbf3c8cdd7e1c9.6e.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/591849a8622c4924a6dd86506b16484e/triggers/manual/paths/invoke?api-version=1"; // Pega la URL de tu flujo HTTP

    document.getElementById("formSolicitud").addEventListener("submit", async function(e) {
      e.preventDefault(); // Evita que el formulario se recargue
      
      const datos = {
        titulo: document.getElementById("titulo").value,
        fechaInicio: document.getElementById("fechaInicio").value,
        fechaFin: document.getElementById("fechaFin").value,
        destino: document.getElementById("destino").value,
        equipoEmpresa: document.getElementById("equipoEmpresa").checked,
        vpn: document.getElementById("vpn").checked,
        dispositivoMovil: document.getElementById("dispositivoMovil").checked,
        comentarios: document.getElementById("comentarios").value
      };

      try {
        const response = await fetch(flujoUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(datos)
        });

        if (response.ok) {
          alert("Solicitud enviada correctamente!");
          document.getElementById("formSolicitud").reset();
        } else {
          alert("Error al enviar la solicitud. Revisá la consola para más detalles.");
          console.error(await response.text());
        }
      } catch (error) {
        alert("Error de conexión al enviar la solicitud.");
        console.error(error);
      }
    });
  </script>
</body>
</html>
